namespace = suelg_spawn_resource

# Calculate the chance for an orbital deposit to spawn 
planet_event = {
    id = suelg_spawn_resource.1
    hide_window = yes
    is_triggered_only = yes

	trigger = {
		suelg_can_have_orbital_deposits = yes
	}

	immediate = {
		# set_variable = { which = test value = value:suelg_advanced_survey_lvl_factor } # for debug
		# log = ">> TEST FACTOR. VALUE: [this.test] THIS: [This.GetName]"

		# log = ">> CHECK DEPOSIT. FROM: [from.GetName] THIS: [This.GetName] ROOT: [root.GetName] FROMFROM: [fromfrom.GetName]"

		random_list = {
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "mineral" ADD = @suelg_mineral_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector F = 1.05 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector_2 F = 1.10 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector_3 F = 1.15 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN minerals. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.2 } # Spawn mineral deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "energy" ADD = @suelg_energy_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector F = 1.05 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector_2 F = 1.10 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector_3 F = 1.15 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN energy. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.3 } # Spawn energy deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "trade" ADD = @suelg_trade_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector F = 1.05 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector_2 F = 1.10 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_prospector_3 F = 1.15 }

				# log = ">> SPAWN trade. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.4 } # Spawn trade deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "alloy" ADD = @suelg_alloy_spawn_base_weight }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN alloy. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.5 } # Spawn alloy deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "zro" ADD = @suelg_zro_spawn_base_weight }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN zro. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.6 } # Spawn zro deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "dark_matter" ADD = @suelg_dark_matter_spawn_base_weight }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN dark_matter. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.7 } # Spawn dark_matter deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "physics" ADD = @suelg_physics_spawn_base_weight }
				modifier = { add = @suelg_physics_spawn_base_weight can_have_minor_physics_deposits = yes }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant F = 1.05 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant_2 F = 1.10 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant_3 F = 1.15 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_mining_station
				}

				# log = ">> SPAWN physics. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.8 } # Spawn physics deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "society" ADD = @suelg_society_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant F = 1.05 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant_2 F = 1.10 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant_3 F = 1.15 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_mining_station
				}

				# log = ">> SPAWN society. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.9 } # Spawn society deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "engineering" ADD = @suelg_engineering_spawn_base_weight }
				modifier = { add = @suelg_engineering_spawn_base_weight can_have_minor_engineering_deposits = yes }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant F = 1.05 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant_2 F = 1.10 }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_observant_3 F = 1.15 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_mining_station
				}

				# log = ">> SPAWN engineering. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.10 } # Spawn engineering deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "volatile_motes" ADD = @suelg_volatile_motes_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_midas_touch F = 1.10 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN volatile_motes. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.11 } # Spawn volatile_motes deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "rare_crystals" ADD = @suelg_rare_crystals_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_midas_touch F = 1.10 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN rare_crystals. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.12 } # Spawn rare_crystals deposit
			}
			0 = {
				inline_script = { script = suelg_ev_can_resorce_mbase RES = "exotic_gases" ADD = @suelg_exotic_gases_spawn_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = leader_trait_midas_touch F = 1.10 }

				modifier = {
					factor = 0
					has_deposit_for = shipclass_research_station
				}

				# log = ">> SPAWN exotic_gases. THIS: [This.GetName]"
				planet_event = { id = suelg_spawn_resource.13 } # Spawn exotic_gases deposit
			}
			0 = {
				modifier = { add = @suelg_orbital_deposit_fail_base_weight }
				inline_script = { script = suelg_add_mfactor_btrait T = subclass_scientist_explorer F = 0.95 }
				modifier = { factor = value:suelg_advanced_survey_lvl_factor }

				modifier = {
					factor = @suelg_mining_orbital_dep_exist_fail_factor
					has_deposit_for = shipclass_mining_station
				}
				modifier = {
					factor = @suelg_scince_orbital_dep_exist_fail_factor
					has_deposit_for = shipclass_research_station
				}

				# log = ">> fail spawn. THIS: [This.GetName]"
			}
		}
	}
}

# Spawn mineral deposit
planet_event = {
	id = suelg_spawn_resource.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_10 = { D = d_minerals }

		suelg_add_habitat_deposit_and_flag = {
			MAX_DEP_LVL = 10
			HAB_DEP_TYPE = d_hab_minerals
			FLAG_TYPE = mining
		}

		suelg_new_basic_dep_message = { TYPE = d_minerals }
	}
}

# Spawn energy deposit
planet_event = {
	id = suelg_spawn_resource.3
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_10 = { D = d_energy }

		suelg_add_habitat_deposit_and_flag = {
			MAX_DEP_LVL = 10
			HAB_DEP_TYPE = d_hab_energy
			FLAG_TYPE = energy
		}

		suelg_new_basic_dep_message = { TYPE = d_energy }
	}
}

# Spawn trade deposit
planet_event = {
	id = suelg_spawn_resource.4
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_10 = { D = d_trade_value }
		suelg_new_basic_dep_message = { TYPE = d_trade_value }
	}
}

# Spawn alloy deposit
planet_event = {
	id = suelg_spawn_resource.5
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_5 = { D = d_alloys }

		suelg_get_habitat_and_orbital = yes
		if = {
			limit = { exists = event_target:t_orbital }
			event_target:t_habitat = {
				suelg_add_deposit_5 = { D = d_hab_alloy }
				suelg_new_habitat_dep_message = { TYPE = d_hab_alloy }
			}
		} else = {
			suelg_new_rare_dep_message = { TYPE = d_alloys }
		}
	}
}

# Spawn zro deposit
planet_event = {
	id = suelg_spawn_resource.6
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_5 = { D = d_zro_deposit }

		suelg_get_habitat_and_orbital = yes
		if = {
			limit = { exists = event_target:t_orbital }
			event_target:t_habitat = {
				suelg_add_deposit_5 = { D = d_hab_zro }
				suelg_new_habitat_dep_message = { TYPE = d_hab_zro }
			}
		} else = {
			suelg_new_rare_dep_message = { TYPE = d_zro_deposit }
		}
	}
}

# Spawn dark_matter deposit
planet_event = {
	id = suelg_spawn_resource.7
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_3 = { D = d_dark_matter_deposit }
		suelg_get_habitat_and_orbital = yes
		if = {
			limit = { exists = event_target:t_orbital }
			event_target:t_habitat = {
				suelg_add_deposit_3 = { D = d_hab_dark_matter }
				suelg_new_habitat_dep_message = { TYPE = d_hab_dark_matter }
			}
		} else = {
			suelg_new_rare_dep_message = { TYPE = d_dark_matter_deposit }
		}
	}
}

# Spawn physics deposit
planet_event = {
	id = suelg_spawn_resource.8
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_10 = { D = d_physics }
		suelg_set_habitat_type = { TYPE = research_habitat }

		suelg_new_science_dep_message = { TYPE = d_physics }
	}
}

# Spawn society deposit
planet_event = {
	id = suelg_spawn_resource.9
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_10 = { D = d_society }
		suelg_set_habitat_type = { TYPE = research_habitat }

		suelg_new_science_dep_message = { TYPE = d_society }
	}
}

# Spawn engineering deposit
planet_event = {
	id = suelg_spawn_resource.10
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_10 = { D = d_engineering }
		suelg_set_habitat_type = { TYPE = research_habitat }

		suelg_new_science_dep_message = { TYPE = d_engineering }
	}
}

# Spawn volatile_motes deposit
planet_event = {
	id = suelg_spawn_resource.11
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_5 = { D = d_volatile_motes }

		suelg_get_habitat_and_orbital = yes
		if = {
			limit = { exists = event_target:t_orbital }
			event_target:t_habitat = {
				suelg_add_deposit_5 = { D = d_hab_mote }
				suelg_new_habitat_dep_message = { TYPE = d_hab_mote }
			}
		} else = {
			suelg_new_rare_dep_message = { TYPE = d_volatile_motes }
		}
	}
}

# Spawn rare_crystals deposit
planet_event = {
	id = suelg_spawn_resource.12
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_5 = { D = d_rare_crystals }

		suelg_get_habitat_and_orbital = yes
		if = {
			limit = { exists = event_target:t_orbital }
			event_target:t_habitat = {
				suelg_add_deposit_5 = { D = d_hab_crystal }
				suelg_new_habitat_dep_message = { TYPE = d_hab_crystal }
			}
		} else = {
			suelg_new_rare_dep_message = { TYPE = d_rare_crystals }
		}
	}
}

# Spawn exotic_gases deposit
planet_event = {
	id = suelg_spawn_resource.13
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		suelg_add_deposit_5 = { D = d_exotic_gases }

		suelg_get_habitat_and_orbital = yes
		if = {
			limit = { exists = event_target:t_orbital }
			event_target:t_habitat = {
				suelg_add_deposit_5 = { D = d_hab_gas }
				suelg_new_habitat_dep_message = { TYPE = d_hab_gas }
			}
		} else = {
			suelg_new_rare_dep_message = { TYPE = d_exotic_gases }
		}
	}
}